# xc3sprog: инструментарий JTAG
 
xc3sprog это набор утилит для программирования микросхем Xilinx FPGA, CPLD и EEPROM через Xilinx Parallel Cable и другие адаптеры JTAG. xc3sprog запускается как приложение с интерфейсом командной строки на операционных системах Linux и Windows.

Основные возможности включают:

• Чтение файла *.BIT, который генерирует инструментарий разработки Xilinx, и программирование его в FPGA.
• Чтение файла JEDEC и программирование его в CPLD.
• Программирование файла *.BIT в конфигурационную память PROM, находящуюся на плате системы.
• Программирование двоичного образа в память flash с интерфейсом SPI, находящуюся на плате системы.
• Чтение содержимого чипа PROM обратно в файл.
• Программирование микроконтроллеров AVR.

Функционал xc3sprog подобен функционалу утилиты Xilinx IMPACT. Есть также сходство с другими бесплатными инструментами JTAG, такими как UrJTAG [6]. Однако xc3sprog имеет некоторое количество достоинств, собранных вместе:

• xc3sprog является свободным программным обеспечением.
• xc3sprog работает как утилита командной строки.
• xc3sprog работает под Linux без необходимости установки двоичных драйверов кабеля (cable-drivers). Однако некоторые типы кабелей JTAG требуют загрузки firmware.
• xc3sprog использует опциональный файл конфигурации для распознавания новых устройств JTAG.
• xc3sprog содержит алгоритмы программирования для поддерживаемых устройств, позволяя прямое использование двоичных файлов (.BIT / JEDEC), полученных от средств их разработки (в отличие от использования промежуточных файлов SVF/STAPLE).

Первая версия xc3sprog была написана Andrew Rogers. Затем код был улучшен и расширен Uwe Bonnes и другими разработчиками.

Как следует из имени утилиты, xc3sprog была изначально разработана для программирования микросхем Xilinx Spartan-3 FPGA. Однако затем утилита была усовершенствована для поддержки некоторых других типов устройств, включая микросхемы Xilinx FPGA, CPLD, XCF flash PROM, Atmel AVR и чипы SPI flash.

Документация. Прочитайте руководство [2] (или см. раздел "Быстрый старт" ниже) чтобы быстро ознакомиться с установкой и использованием xc3sprog, или обратитесь к встроенной справке или странице руководства [3] (или см. врезку "Руководство пользователя" ниже) для получения подробных инструкций по использованию утилиты. Просмотрите список поддерживаемой аппаратуры [4] (также дан во врезке "Оборудование, поддерживаемое xc3sprog"), чтобы определить, поддерживается ли Ваша целевая плата и кабель JTAG.

Лицензия. xc3sprog лицензируется под GNU General Public License (GPL version 2 или более свежей версии). Подробнее см. файлы README и COPYING, находящиеся в репозитории исходного кода xc3sprog.

Информационная рассылка. Пользователи могут использовать список рассылки xc3sprog-users (http://sourceforge.net/mail/?group_id=170565) для общего обсуждения вопросов, касающихся xc3sprog. Приветствуются вопросы, замечания и сообщения об ошибках.

[Быстрый старт]

Установка под Linux. Чтобы получить xc3sprog, сначала загрузите исходный код с SourceForge:

```shell
svn co https://xc3sprog.svn.sourceforge.net/svnroot/xc3sprog/trunk xc3sprog
```
Затем скомпилируйте установите программу:

```shell
cd xc3sprog
cmake .
make
make install
```
Установка под Windows. Собственно установки никакой нет. Скачайте архив build-win32_rev780_stripped.tar.gz (rev780 обозначает версию утилиты, и эта часть имени может быть другой), распакуйте его содержимое в любую папку на диске, настройте пути запуска в переменной окружения %PATH%.

Как использовать. Подключите кабель JTAG к компьютеру, и подключите этот кабель к своей рабочей плате (которую собираетесь программировать). Запустите утилиту xc3sprog, и проверьте, что она детектирует цепочку JTAG платы. Тип кабеля JTAG должен быть указан в опции командной строки. Просмотрите таблицу поддерживаемого оборудования [4], чтобы найти имя (label, метку опции) для Вашего типа кабеля. В этом примере используется кабель JTAG, подключенный к параллельному порту:

```shell
xc3sprog -c pp
```
![screen1](xc3sprog_screen1.png)

Следующий пример показывает, как прошивать FPGA. Плата в этом примере содержит XCF PROM в позиции 0 и Xilinx FPGA в позиции 1.

Мы указываем позицию 1 в цепочке (chain position 1) для прямого программирования FPGA. Новая программа вступит в силу немедленно, но это будет работать только до того момента, пока присутствует питание на плате (после выключения питания и повторного включения конфигурация будет потеряна). Чтобы перешить плату на постоянную работу, требуется запрограммировать flash PROM, для этого выбирается позиция 0.
```shell
xc3sprog -c pp -v -p 1 filename.bit
```
![screen2](xc3sprog_screen2.png)

xc3sprog поддерживает множество настроек для других плат и других операций по программированию. Подробнее см. руководство [3] (или врезку "Руководство пользователя"), где имеется описание команд, опций и другие примеры использования.



## Программируемые устройства:

• Xilinx XC95X series
• Xilinx CoolRunner-II
• Xilinx Spartan-2
• Xilinx Spartan-3
• Xilinx Spartan-6
• Xilinx Virtex-2 (не тестировалось)
• Xilinx Virtex-5
• Xilinx 7 Series (Virtex-7, Kintex-7, Artix-7; tested on XC7VX690T, XC7A200T)
• Xilinx Zynq 7000 (only logic, not ARM)
• Xilinx Platform Flash XCFnnS
• Xilinx Platform Flash XCFnnP (ограниченная функциональность)
• Atmel AVR: ATmega, Xmega
• SPI flash: AT45, AMIC, AMIC-QUAD, M25P, N25Q, S33, W25

## Поддерживаемые кабели JTAG:

label	|Интерфейс|	Описание
----------|----------|----------
pp	   |parallel port	|Xilinx Parallel Cable III (DLC5), или Altera ByteBlaster
ftdi   |USB|Стандартный кабель JTAG на основе чипа FTDI (FT2232C, FT232H или совместимый)
bbv2   |USB|	Bus Blaster v2 (DangerousPrototypes)
bbv2_2 |USB|Bus Blaster v2, internal JTAG port
amontec|USB|	Amontec JTAGkey
olimex |USB|Адаптер Olimex USB-JTAG
jtaghs1|USB|	Кабель Digilent JTAG-HS1
jtaghs2|USB|	Кабель Digilent JTAG-HS2
ikda	  |USB|	 
llbbc	 |USB|	 
llif	  |USB|	 
llbus	 |USB|	 
ftdijtag	|USB|	 
ft2232test	|USB|	 
l_motctl	|USB|	 
l_motctl_avr	 	 
knob2usb	|USB|	 
qm07_pu	|USB|	 
xpc	|USB|	Xilinx Platform Cable USB II (DLC10), или программатор, встроенный в плату разработчика (например, Spartan 3E starter kit)
llbbc08	|USB|	 
qdu16	|USB|	 


